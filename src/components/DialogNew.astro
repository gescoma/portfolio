---
import Close from "./icons/Close.astro"
---

<div class="dialog">
  <div class="dialog__close">
    <Close width="100%" height="100%" />
  </div>
  <div class="dialog__body">
    <slot />
  </div>
</div>

<style>
  .dialog {
    display: none;
    visibility: hidden;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  :global(.card__active) .dialog {
    display: block;
    visibility: visible;
  }


  .dialog__close-button {
    position: absolute;
    top: -0.5rem;
    right: -0.5rem;
    border: none;
    padding: 0;
    background: none;
    cursor: pointer;
    color: #95a5a6;
    transition: color 0.1s cubic-bezier(0.22, 1, 0.36, 1);
    width: 2rem;
    height: 2rem;
  }

  .dialog__close-button:hover,
  .dialog__close-button:focus,
  .dialog__close-button:active {
    color: black;
  }

  @media (min-width: 992px) {
    .dialog__close-button {
      width: 3rem;
      height: 3rem;
    }
  }
</style>

<script>
  import { openDialog } from "../scripts/dialogPortal"
  const $$ = (element: string) => document.querySelectorAll<HTMLElement>(element)
  const cards = $$(".card-clickable")

  if (cards.length > 0) {
    cards.forEach((card: HTMLElement) => {
      card.addEventListener("click", (e) => {
        if (e.currentTarget !== card) return
        const dialog = card.querySelector<HTMLElement>(".dialog")
        if(!dialog) throw new Error("Dialog not found")
        openDialog(dialog)
      })
    })
  }
</script>
